/home/jiachen/miniconda3/envs/qwen3/lib/python3.10/site-packages/transformers/utils/hub.py:107: FutureWarning: Using `TRANSFORMERS_CACHE` is deprecated and will be removed in v5 of Transformers. Use `HF_HOME` instead.
  warnings.warn(
`torch_dtype` is deprecated! Use `dtype` instead!


======================================================================
V8 LLM-Guided Granularity Pipeline - Image 713619
======================================================================

Step 1: Loading Visual Genome data...
✓ Loaded 26 objects

Step 2: Building LLM-guided 3-level hierarchy...

Building LLM-guided 3-level hierarchy...
Processing 9 unique objects with LLM selector

Hierarchy built:
  Fine-grained: 9 concepts
  Mid-level: 7 concepts
  Coarse-level: 3 concepts
  Compression: 1.29x (Fine→Mid), 3.00x (Fine→Coarse)

LLM Performance:
  LLM Success: 7/9 (77.8%)
  Fallback: 1/9 (11.1%)

Step 3: Visualizing original scene graph...

Creating scene graph visualization...
Saved scene graph: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/original_scene_graph.png

Step 4: Creating hierarchical ontology tree...

Creating hierarchy tree visualization...
Saved hierarchy tree: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/hierarchical_ontology_tree.png

Step 5: Creating merged scene graphs...

Visualizing merged fine-grained scene graph...
Saved merged fine-grained visualization: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/merged_fine.png

Visualizing merged mid-grained scene graph...
Saved merged mid-grained visualization: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/merged_mid.png

Visualizing merged coarse-grained scene graph...
Saved merged coarse-grained visualization: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/merged_coarse.png

Step 6: Creating merged comparison...

Step 7: Analyzing WordNet paths...
✓ Saved WordNet paths tree: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/wordnet_paths_tree.png
✓ Saved merge analysis: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/wordnet_merge_analysis.png
✓ Saved depth distribution: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/depth_distribution.png

Step 8: Creating merged concepts flow diagrams...

Creating concept flow diagram...
✓ Saved concept flow diagram: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/merged_concepts_flow.png

Creating concept hierarchy table...
✓ Saved concept hierarchy table: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/concept_hierarchy_table.png

Creating compression analysis...
✓ Saved compression analysis: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/compression_analysis.png

Step 8b: Creating graph structure visualizations...
✓ Saved combined graph comparison: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/graph_structure_comparison.png
✓ Saved fine-grained graph: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/graph_structure_fine.png
✓ Saved mid-grained graph: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/graph_structure_mid.png
✓ Saved coarse-grained graph: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/graph_structure_coarse.png
✓ Saved graph statistics report: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/GRAPH_STRUCTURE_REPORT.md

Step 9: Generating reports...
✓ Saved WordNet analysis report: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/WORDNET_ANALYSIS_REPORT.md

Generating concept mapping report...
✓ Saved concept mapping report: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619/CONCEPT_MAPPING_REPORT.md

======================================================================
✅ V8 Pipeline Complete!
======================================================================

LLM Performance Summary:
  Success: 7/9 (77.8%)
  Fallback: 1/9 (11.1%)

Output directory: /nas/jiachen/graph_reasoning/HCNMN/inspect/batch_results/v8/sample_713619/sample_713619
Generated files:
  1. original_scene_graph.png
  2. hierarchical_ontology_tree.png
  3. merged_fine.png
  4. merged_mid.png
  5. merged_coarse.png
  6. merged_comparison.png
  7. wordnet_paths_tree.png
  8. wordnet_merge_analysis.png
  9. depth_distribution.png
  10. merged_concepts_flow.png
  11. concept_hierarchy_table.png
  12. compression_analysis.png
  13. ontology_data.json
  14. wordnet_paths_data.json
  15. MERGED_SCENE_GRAPH_REPORT.md
  16. WORDNET_ANALYSIS_REPORT.md
  17. CONCEPT_MAPPING_REPORT.md
  18. V8_LLM_METHOD.md
  19. graph_structure_comparison.png
  20. graph_structure_fine.png
  21. graph_structure_mid.png
  22. graph_structure_coarse.png
  23. GRAPH_STRUCTURE_REPORT.md

✅ V8 visualization complete!

